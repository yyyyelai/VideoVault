# VideoVault - 本地视频管理工具

一个基于 Tauri 的本地硬盘视频管理工具，支持封面展示、多文件夹管理、视频播放等功能。

## 核心功能

### 视频管理
- 自动扫描指定文件夹中的视频文件
- 支持多种视频格式 (MP4, AVI, MKV, MOV, WMV, FLV, WebM 等)
- 自动关联同名封面图片
- 视频信息展示 (文件名、路径、大小、时长、分辨率、编码格式等)
- 一键唤起系统默认播放器播放视频
- 视频元数据解析 (使用 ffprobe 外部工具)
- 支持视频时长、帧率、比特率等详细信息

### 文件夹管理
- 支持添加多个根文件夹作为视频源
- 每个根文件夹支持多级子目录结构
- 按根文件夹和目录层级筛选
- 支持跨文件夹的全局搜索
- 文件夹的启用/禁用状态管理
- 删除已添加的根文件夹
- 并行目录扫描 (多线程处理)
- 目录树缓存机制 (提升性能)
- 面包屑导航系统
- 文件夹历史记录（对象化：path/rootId/volumeKey/addedAt）
- 根 ID 幂等（UUID v5：基于卷标识+标准化路径）
- Windows 卷标识支持（vol 获取序列号，跨硬盘缓存隔离）
- 扫描性能优化：使用 DirEntry::file_type() 减少额外 metadata 调用

### 缓存与启动体验
- 本地缓存：按 `volumeKey + rootId` 命名空间存储目录树
- 扫描策略：SWR（命中缓存即刻渲染，可选后台刷新）
- `scanDirectory(rootId, revalidate?)`：支持跳过刷新（命中缓存不请求后端）
- 冷启动：从历史最新项直接从缓存 hydrate 界面

### 封面管理
- 自动检测封面文件 (JPG, PNG, BMP, WebP)
- 智能匹配视频和封面文件
- 图片预览功能 (base64 编码)
- 封面文件信息展示
- 支持多种图片格式

### 用户界面
- 响应式设计，支持不同屏幕尺寸
- 网格视图和列表视图切换
- 动态背景和动画效果 (Magic UI 组件)
- 加载状态和错误提示
- 模态对话框操作
- 图片预览弹窗
- 成功/错误消息提示
- 文件夹操作确认对话框

### 系统集成
- 系统默认播放器集成
- 系统文件夹浏览器集成
- 跨平台文件路径处理
- 系统命令执行支持

## 技术架构

- **前端**: React + TypeScript + Vite
- **后端**: Rust + Tauri v2
- **样式**: Tailwind CSS + Magic UI 组件
- **构建工具**: Vite
- **包管理**: npm

### 核心依赖库

#### Rust 后端
- **tauri**: 跨平台桌面应用框架
- **serde**: 序列化/反序列化
- **ffprobe**（外部依赖）: 视频元数据解析
- **rayon**: 并行计算
- **chrono**: 时间处理
- **uuid**: 唯一标识符生成
- **base64**: 图片编码
- **regex**: 正则表达式
- **log**: 日志系统

#### 前端
- **React 19**: 用户界面库
- **TypeScript**: 类型安全
- **Tailwind CSS**: 样式框架
- **Magic UI**: 精美组件库
- **Lucide React**: 图标库
- **Motion**: 动画库

### 架构特点
- **前后端分离**: React 前端 + Rust 后端
- **跨平台支持**: Windows, macOS, Linux
- **高性能**: Rust 后端 + 并行处理
- **模块化设计**: 清晰的代码结构和职责分离
- **类型安全**: 全栈 TypeScript + Rust 类型系统

## Magic UI 组件

应用使用了以下 Magic UI 组件来提供精美的视觉效果：

- **ShimmerButton**: 闪光效果的按钮组件
- **AnimatedGridPattern**: 动态网格背景图案
- **DotPattern**: 点状背景图案
- **RetroGrid**: 复古网格背景效果

## 安装和运行

### 环境要求
- Node.js 18+
- Rust 1.82+
- Tauri CLI v2

### 开发环境
```bash
# 安装依赖
npm install

# 启动开发服务器
npm run dev

# 构建应用
npm run build

# 构建 Tauri 应用
npm run tauri build
```

## 开发计划

### ✅ 已完成
- [x] 项目初始化和基础架构搭建
- [x] Tauri v2 集成和配置
- [x] 基础 UI 界面设计
- [x] 文件夹扫描和管理功能
- [x] 视频文件检测和关联
- [x] 封面图片自动关联
- [x] 系统播放器集成
- [x] 多根文件夹管理
- [x] 文件夹删除功能
- [x] Magic UI 组件集成
- [x] 响应式设计实现
- [x] 白色主题配色方案
- [x] 视频元数据提取（ffprobe）
- [x] 并行目录扫描 (使用 Rayon)
- [x] 目录树缓存机制
- [x] 面包屑导航系统
- [x] 网格视图和列表视图切换
- [x] 图片预览功能 (base64 编码)
- [x] 文件夹历史记录（对象化 path/rootId/volumeKey，去重）
- [x] 系统文件夹打开功能
- [x] 错误处理和用户提示
- [x] 加载状态管理
- [x] 启动时从历史缓存恢复上次选中
- [x] 扫描性能优化
- [x] 按文件名搜索

### 📋 待开发
- [ ] 图片处理优化 (ImageMagick 集成)
- [ ] 设置页面和配置管理
- [ ] 视频缩略图生成
- [ ] 标签和分类系统
- [ ] 数据库持久化存储
- [ ] 插件系统支持
- [ ] 缓存策略可配置（TTL、最大条目、清理）
- [ ] 视频元数据解析限流与懒加载（减少首扫耗时）

## UI/UX 特色

### 设计风格
- **主题**: 采用 Magic UI 的默认白色主题，清新现代
- **配色**: 以白色为主色调，搭配灰色和黑色作为辅助色
- **布局**: 侧边栏 + 主内容区的经典布局设计
- **响应式**: 支持桌面端和移动端的自适应布局

### 交互体验
- **动画效果**: 使用 Magic UI 组件提供的流畅动画
- **视觉反馈**: 悬停、点击、加载等状态的视觉反馈
- **无障碍**: 合理的颜色对比度和可读性

## 技术挑战

- **多根文件夹管理**: 实现复杂的文件夹层级结构
- **文件关联**: 自动匹配视频文件和封面图片
- **性能优化**: 大文件夹扫描和渲染性能
- **跨平台兼容**: 不同操作系统的文件路径处理
- **Magic UI 集成**: 组件库的深度集成和定制

## 已知问题

- Tailwind CSS 自定义颜色类警告 (已解决)
- Magic UI 类型导入警告 (已解决)
- PostCSS 配置问题 (已解决)

## 贡献指南

欢迎提交 Issue 和 Pull Request 来改进这个项目。

## 许可证

MIT License
